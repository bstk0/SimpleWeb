<!DOCTYPE HTML><html><head>    <meta charset="utf-16" />    <title>{{SAP_ADMIN_MAPPING_TITLE}}</title>    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.20/datatables.min.css" />    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/1.11.8/semantic.min.css" />    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>    <script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.20/datatables.min.js"></script>    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/1.11.8/semantic.min.js"></script>    <script src="https://cdn.jsdelivr.net/g/filesaver.js"></script>    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script></head><body>    <div id="page-container">        <div id="content-wrap">            <div class="ui top fixed item menu" id="tmen">                <div class="ui container">                    <a class="active item" style="color:white; "><b>CPI DocER<b></a>                </div>            </div>            <div class="pusher scaledown" style="width:100%">                <div style="padding: 4%;">                    <!--<button class="ui compact icon button primary" id="toggle-menu" style="margin-left:2%">                    <i class="th list icon"></i>                  </button>-->                    <div style="display: flex; width: 100%; flex-flow:wrap">                        <div style="flex: 1 0 30%;padding:16px">                            <p>Integration package</p>                            <div class="ui selection dropdown fluid">                                <input type="hidden" name="integration-package" id="integration-package">                                <i class="dropdown icon"></i>                                <div class="default text">Select</div>                                <div class="menu" id="integration-packages-data">                                </div>                            </div>                        </div>                        <div style="flex: 1 0 30%;padding:16px">                            <p>Integration Flow</p>                            <div class="ui selection dropdown fluid">                                <input type="hidden" name="integration-flow" id="integration-flow">                                <i class="dropdown icon"></i>                                <div class="default text">Select</div>                                <div class="menu" id="integration-flows-data">                                </div>                            </div>                        </div>                        <div style="flex: 1 0 40%;padding:16px">                            <p>Message Mapping</p>                            <div class="ui selection dropdown fluid">                                <input type="hidden" name="message-mapping" id="message-mapping">                                <i class="dropdown icon"></i>                                <div class="default text">Select</div>                                <div class="menu" id="integration-messagemapping-data">                                </div>                            </div>                        </div>                    </div>                    <div style="width: 100%;padding:3%;overflow-x: auto;">                        <table id="results-table" class="ui celled table" style="width: 100%;">                            <div style="margin:16px; float:right">                                <button class="ui button primary" id="download-results">Download as Excel</button>                            </div>                            <thead>                                <tr>                                    <th>Source</th>                                    <th>Constants</th>                                    <th>Functions</th>                                    <th>Target</th>                                </tr>                            </thead>                            <tbody id="results-table-body">                            </tbody>                        </table>                    </div>                </div>            </div>                    </div><footer id="footer" class="ui inverted vertical footer segment form-page">                <h4 class="ui inverted header">Developed by - <a href="https://www.linkedin.com/in/santhoshkumarvellingiri/" target="_blank">Santhosh Kumar Vellingiri</a></h4></footer></div></body><script>    function SaveAsFile(t, f, m) {        try {            var b = new Blob([t], {                type: m            });            saveAs(b, f);        } catch (e) {            window.open("data:" + m + "," + encodeURIComponent(t), '_blank', '');        }    }    function s2ab(s) {        var buf = new ArrayBuffer(s.length); //convert s to arrayBuffer        var view = new Uint8Array(buf); //create uint8array as viewer        for (var i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF; //convert to octet        return buf;    }    $(document).ready(function() {        var integrationPackages = {};        var integrationFlows = {};        var messageMappings = {};        $("#toggle-menu").click(function() {            $('.ui.sidebar')                .sidebar({                    transition: 'push'                })                .sidebar('toggle')        })        const url = "{{SCPI_Dev_Tools}}";        const withCred = false;        let results = []        let xlData = []        $("#results-table").DataTable({            "order": []        })        $('.ui.selection.dropdown')            .dropdown({                clearable: true,                placeholder: 'any'            });        $('.ui.dropdown')            .dropdown();        $(".launch.button").mouseenter(function() {            $(this).stop().animate({}, 300,                function() {                    $(this).find('.text').show();                });        }).mouseleave(function(event) {            $(this).find('.text').hide();            $(this).stop().animate({}, 300);        });        var data = [];        $.ajax({                url: url + "/iPackage",                type: 'get',                xhrFields: {                    withCredentials: withCred                }            })            .then(function(response) {                let data = response.IntegrationPackage;                let element = $('#integration-packages-data');                for (var i = 0; i < data.length; i++) {                    let item = data[i];                    integrationPackages[item.iD] = item;                    element.append('<div class="item" data-value="' + item.iD + '">' + item.name + '</div>')                }            });        $("#integration-package").change(function(e) {            let value = e.target.value;            let obj = integrationPackages[value];            $.ajax({                    url: url + "/iFlow?id=" + value,                    type: 'get',                    xhrFields: {                        withCredentials: withCred                    }                })                .then(function(response) {                    let data = response.IntegrationFlow;                    let element = $('#integration-flows-data');                    element.empty();                    for (var i = 0; i < data.length; i++) {                        let item = data[i];                        integrationFlows[item.iD] = item;                        element.append('<div class="item" data-value="' + item.iD + '">' + item.name + '</div>')                    }                });        })        $("#integration-flow").change(function(e) {            results = []            let value = e.target.value;            let obj = integrationFlows[value];            $.ajax({                    url: url + "/iMaps?id=" + obj.iD + "&version=" + obj.version,                    type: 'get',                    xhrFields: {                        withCredentials: withCred                    }                })                .then(function(response) {                    let data = response.IntegrationMaps;                    let element = $('#integration-messagemapping-data');                    element.empty();                    for (var i = 0; i < data.length; i++) {                        let item = data[i];                        messageMappings[item.iD] = item                        element.append('<div class="item" data-value="' + item.iD + '">' + item.name + '</div>')                    }                });        })        $('#message-mapping').change(function(e) {            results = []            xlData = []            let value = e.target.value;            let obj = integrationFlows[$('#integration-flow').val()];            $.ajax({                    url: url + "/iMapContent?mapName=" + value + "&id=" + obj.iD + "&version=" + obj.version,                    type: 'get',                    xhrFields: {                        withCredentials: withCred                    }                })                .then(function(response) {                    $('#results-table').DataTable().destroy();                    let data = response.mappingResult;                    let element = $('#results-table-body');                    for (var i = 0; i < data.length; i++) {                        let item = data[i];                        results.push([                            item.sourceFields.replace(/(?:\n)/g, '<br/>') || "-",                            item.constantValues.replace(/(?:\n)/g, '<br/>') || "-",                            item.functionS.replace(/(?:\n)/g, '<br/>') || "-",                            item.targetField || "-"                        ])                        xlData.push([                            item.sourceFields || "-",                            item.constantValues || "-",                            item.functionS || "-",                            item.targetField || "-"                        ])                    }                    $('#results-table').DataTable({                        data: results,                        "order": []                    });                });        })        $("#download-results").click(function() {            var wb = XLSX.utils.book_new();            wb.SheetNames.push("Mapping Documents");            if (xlData.length <= 0) {                alert("No results avaliable to export");                return;            }            var ws = XLSX.utils.aoa_to_sheet([                ['Source', 'Constants', 'Functions', 'Target']            ]);            XLSX.utils.sheet_add_aoa(ws, xlData, {                origin: -1            });            wb.Sheets["Mapping Documents"] = ws;            var wbout = XLSX.write(wb, {                bookType: 'xlsx',                type: 'binary'            });            saveAs(new Blob([s2ab(wbout)], {                type: "application/octet-stream"            }), $('#message-mapping').val() + '.xlsx');        })    })</script><style>    table.dataTable tbody th,    table.dataTable tbody td {        border: 1px solid #aaaaaa !important;    }       table {        table-layout: fixed;    }       td {        overflow: hidden;        /* text-overflow: ellipsis; */        word-break: break-all;    }       .ui.footer.form-page {        position: fixed;        bottom: 0;        border-radius: unset;        margin: 0;        z-index: 9999;        width: 100%;        background-color: #153652 !important;    }       #page-container {        position: relative;        min-height: 100vh;    }       #content-wrap {        padding-bottom: 2.5rem;        /* Footer height */    }       #footer {        position: absolute;        bottom: 0;        width: 100%;        height: 2.5rem;        /* Footer height */    }#tmen{background-color: #153652 !important;}</style></html>